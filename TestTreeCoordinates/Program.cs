using System.Net.Http.Headers;
using System.Text;
using System;
using System.Text.Json.Nodes;
using System.Dynamic;
using System.Text.Json.Serialization;
using System.Text.Json;
using System.Net.Sockets;
using System.Net;

var coords = @"[23.087453413388, 11.5280171538087, 217.0]
[-15.4408435916751, -8.33426677139887, 195.57142857142856] 
[3.14475209868923, 5.44666289246168, 218.71428571428572] 
[-14.9838117031703, -4.14397272110648, 180.52776219854178] 
[15.4605088491328, -1.37250840040442, 189.23163208076278] 
[-20.5242705464914, 16.3915906734184, 177.89999999999998] 
[-6.20206260528492, 1.89019463915783, 207.34138124649076] 
[-2.79112421674281e-06, 9.28948806084855, 217.85714285714278] 
[6.74965447406211, -10.6465718967508, 197.93546576879908] 
[34.900437502174, -35.5887720027881, 179.20606400898373] 
[0.293568672807129, 0.124062565416872, 183.3641975308642] 
[-15.9608326140674, -3.51765182690871, 181.45449438202246] 
[8.97974999320319, 3.93363448529535, 192.35129068462402] 
[-6.91775345543125, -0.0085497176106885, 186.89719101123598] 
[-1.25697349706281, 9.5828657843481, 215.57142857142856] 
[-6.84655137705069, 10.8938755684661, 304.1428571428571] 
[0.234186940560546, 0.0970029256081607, 330.1428571428571] 
[15.757746788624, -4.22223085848786, 222.57142857142856] 
[0.651650117036367, 4.74190499246058, 215.57142857142856] 
[37.1129550983216, -23.8549607887695, 242.1428571428571] 
[4.47922512388171, 4.47929183191247, 216.85714285714278] 
[1.21392535898456e-06, 16.3698241032526, 225.0] 
[0.939549212015834, 7.63904752544464, 216.85714285714278] 
[-0.5818520390641, -0.0004092830810614, 235.85714285714283] 
[1.21089872847397, 4.51565458436762, 216.85714285714278] 
[-15.255653715771, -4.08773653881541, 228.2857142857143] 
[19.6985746254178, 6.37138582750598, 248.71428571428572] 
[51.3011360065697, 32.6006995719034, 249.71428571428572] 
[-10.2837991492817, 0.703431132833731, 221.28571428571428] 
[-2.4331972786818, 20.0529239997614, 271.57142857142856] 
[16.0853235962739, -32.242140997315, 238.0] 
[67.4895276464214, 25.3347373937179, 255.1428571428571] 
[-8.83988911533563, 31.550068507048, 247.42857142857144] 
[4.20501400894256, -2.96820530806964, 329.57142857142856] 
[1.74900358414879, -2.15001276153349, 331.57142857142856] 
[2.03429101837944, 7.59207743797306, 321.0] 
[-8.11096770499747, -1.04528734608055, 237.0] 
[-3.99466504440023, 0.273249840219095, 329.1428571428571] 
[0.446125273758795, 1.08036005999044, 279.57142857142856] 
[19.9103644530288, -1.353667410724, 250.1428571428571] 
[-0.0994304447588564, 0.240066916420809, 328.57142857142856] 
[-2.78211767020256, 0.366399913701762, 217.85714285714278] 
[-3.77640919496594, -9.11301997515984, 218.42857142857144] 
[13.9716105737743, 8.06650299980983, 222.0] 
[10.9670398399282, 5.69054181337877, 327.2857142857143] 
[-28.4373433970273, -22.681996766461, 247.0] 
[4.93713892599964, 2.78390699123671e-16, 337.42857142857144] 
[23.9445655328023, 3.15213761431988, 216.85714285714278] 
[-1.6165298711577, -0.475496006489209, 222.14285714285717] 
[-5.99786988058919, 41.3961510191341, 247.57142857142856] 
[11.2062120874582, -38.3957724577855, 278.85714285714283] 
[13.4191999784458, 20.6845328799753, 235.0] 
[-15.1529355098245, -36.145916820061, 235.42857142857144] 
[8.90886164348569, 19.6849694474788, 222.71428571428572] 
[1.04600650697983, -0.137710805848491, 232.1428571428571] 
[-36.8875185876992, -42.2068003596809, 269.1428571428571] 
[45.1663137312008, -13.2717243923087, 212.3456790123456] 
[6.67675588047689, 25.4618557812006, 259.0] 
[3.11389356514975, -5.37633858028671, 222.85714285714278] 
[24.0639857921118, -9.96886945988488, 270.42857142857144] 
[1.20041505619036, 1.974245766286, 268.1428571428571] 
[42.4968619544491, 15.9208760253909, 265.7142857142857] 
[-19.4769817773244, 19.2378876828935, 239.489898989899] 
[3.65737650640076, 27.9181903976956, 234.2857142857143] 
[43.3722278853454, -3.6432537628675, 188.98262331838566] 
[72.0074678065369, 29.8729235630834, 241.71428571428572] 
[24.3613975883221, -6.4811055673445, 256.4097533632287] 
[10.5007143650092, 5.43891754331244, 270.57142857142856] 
[4.99079173806617, 4.17329388878158, 255.2857142857143] 
[-12.0983494843533, -19.1544775730522, 269.7142857142857] 
[10.6474410349131, -1.37577822660465, 233.85714285714283] 
[19.3766333297304, -20.7729969123043, 241.42857142857144] 
[0.541531240047477, -1.30173844528191, 225.42857142857144] 
[-29.0454256009839, 3.82493738908593, 271.0] 
[34.8913720722649, -32.6867120342343, 271.69899103139016] 
[-21.9341944871244, 16.0443232070692, 269.85714285714283] 
[4.59563812172132, 4.59517493657001, 270.28571428571433] 
[20.4749782328449, 5.48505621740696, 271.0] 
[-10.3634070793544, -7.58925771377091, 242.85714285714283] 
[-8.3807958894599, -13.5495098821735, 321.2857142857143] 
[-4.93369202355724, -1.797209954312, 234.42857142857144] 
[31.6999105232645, -27.4562183920177, 263.42857142857144] 
[2.05019356898644, 0.84701331129988, 211.85714285714278] 
[-4.66905936927753, -0.319371075928944, 317.1428571428571] 
[8.04615049567434, 4.20165952886973, 229.1428571428571] 
[13.6053213296182, -5.34864256825312, 257.0] 
[-12.7872194341497, 7.40709072759829, 284.85714285714283] 
[8.40987985933149, -4.85544069019798, 315.42857142857144] 
[0.581019684609926, 0.757546118819179, 270.1428571428571] 
[0.0003143838091802, 7.70254965182552, 267.7142857142857] 
[65.3308736927824, 13.8481527214036, 254.2617713004484] 
[-0.801014190207748, -0.312145349104799, 270.1428571428571] 
[2.68889543870396, 0.352863123550385, 231.9366236679753] 
[7.81931251101171, -47.1608014492605, 259.0987100392597] 
[42.3251296081579, -5.22050486565093, 201.3744394618834] 
[2.75506920726192, 0.750380603998027, 268.57142857142856] 
[12.4742424626655, 16.2134931961753, 317.8571428571429] 
[-4.71610298890935, 15.322616688963, 320.57142857142856] 
[2.83129018311543, 1.63458385701552, 325.7142857142857] 
[15.7542490409465, 23.1684753698345, 272.0] 
[2.52694255078377, 0.900078201465464, 238.97701793721973] 
[-22.7821246003621, -7.51950629787549, 200.1016282987086] 
[2.08953775310832, -0.150273898914609, 329.8571428571429] 
[21.4535890325383, -8.00668492201686, 206.4719416386083] 
[52.7556661310063, -0.108078678970699, 270.53954010095345] 
[-1.18746513330783, -4.43071116510828, 227.2857142857143] 
[2.04258785854078, 2.31456665417541, 188.64121280179677] 
[-0.742599771889565, 1.79340395935673, 217.71428571428572] 
[-2.92656625520346, -1.05108633998811, 324.42857142857144] 
[17.2904189481742, 0.494456055657885, 238.57142857142856] 
[-1.1135651211887, -0.146686386597978, 328.1428571428571] 
[11.8792157281776, 18.6211120466454, 245.71428571428572] 
[-0.311189710804969, -0.238789684820962, 334.2857142857143] 
[-3.02014029320909, 0.466708376588646, 256.85714285714283] 
[-0.742370707398457, 0.0529839988234004, 337.1428571428571] 
[42.0578235888043, -5.34999499415864, 215.0] 
[0.047747288255661, -0.0006594670717159, 330.57142857142856] 
[12.2015231148197, 30.3704567208006, 240.57142857142856] 
[-0.0812188071720437, -0.0230141463431666, 336.8571428571429] 
[26.2201702370483, -7.21048202028874, 262.42857142857144] 
[-1.93806955610758, 0.0245940463855363, 344.1428571428571] 
[-16.9028086286377, -4.63161625525643, 241.85714285714283] 
[0.628165592954907, -0.58890466476004, 315.7142857142857] 
[-5.09410596278223, 5.09350809658407, 217.71428571428572] 
[-4.55226165963247, -10.1567983208884, 220.46378439079172] 
[-2.37456856017565, -0.158460111049737, 299.8571428571429] 
[48.8293688956847, 10.1484654407701, 267.1238789237668] 
[5.83966284331454, 1.56477127578505, 254.1428571428571] 
[1.04493725671447, 0.314360275796243, 326.8571428571429] 
[-39.010527481054, 9.20328835294377, 244.1428571428571] 
[4.70420977632675, 0.0531811520140775, 341.2857142857143] 
[-9.25353313187532, 19.3312217892882, 251.42857142857144] 
[-55.6489350590794, -1.11181165501022, 274.57142857142856] 
[-0.920155660425939, -0.715997538402085, 214.28571428571428] 
[4.1814527844378, 2.97651629215782, 259.42857142857144] 
[-9.41947170440898, 1.32129457743281, 224.55213004484304] 
[-15.8547602663012, -41.9512137724402, 261.28571428571433] 
[-24.6015274442341, -16.0550070159829, 224.2378014582165] 
[2.18066476094108, 0.435799529427541, 265.28571428571433] 
[3.04271367201582, -7.54026142792286, 255.1428571428571] 
[9.7578464552175, 31.7854563036558, 268.7142857142857] 
[-21.6641187754939, 1.75948464576615, 275.0] 
[-1.17018545621608, -1.43808290751877, 327.57142857142856] 
[-50.4814490078075, -4.26200892279782, 180.23694553621561] 
[-1.35004081995181, -0.0921435204533457, 334.2857142857143] 
[50.8809335255699, -5.94927410139777, 225.2857142857143] 
[-12.6989099109856, -1.94363045196894, 280.7142857142857] 
[0.0399948044901238, 0.0097399283063381, 214.347923681257] 
[1.7070894122938, -11.1631886886591, 273.57142857142856] 
[-15.9968169606035, -22.6566549043, 229.53168816601232] 
[-4.2880968959533, -0.0001011788851647, 337.8571428571429] 
[18.1864301769378, -4.78827067413696, 223.6573191250701] 
[3.01819608149138, -1.74032232985654, 283.42857142857144] 
[-17.2981439507374, -2.06483720451981, 238.71428571428572] 
[0.250575613439258, 1.97286053292623, 270.57142857142856] 
[-1.84902764445046, 0.371071954559184, 235.1428571428571] 
[-1.10739054658396, -0.146289792336793, 332.42857142857144] 
[68.974728624148, 19.5962466009041, 241.57142857142856] 
[0.820100247202086, 0.19022068495294, 308.1428571428571] 
[-1.46412888773277, 3.55900257192439, 279.1428571428571] 
[-5.48591884429489, -1.38995002563881, 288.0] 
[-36.6631102473242, 3.21175348009736, 217.57142857142856] 
[2.7149316423066, 0.186241162347638, 300.42857142857144] 
[22.6957510764015, -11.1846418544994, 244.26008968609867] 
[2.48707409659823, -1.43574380883554, 334.7142857142857] 
[-0.905110067595386, 0.0650261330410333, 348.7142857142857] 
[-5.82408675257984, 1.2454761613248, 214.0] 
[-19.3090875055982, -8.36582195609595, 230.85714285714283] 
[3.6380731852572, 0.475012592695753, 257.0] 
[22.4895509653759, -16.4123042673762, 278.1428571428571] 
[3.81707835846233, -9.47857852225387, 214.42857142857144] 
[-7.87930595980705, 1.06411408465489, 211.42857142857144] 
[1.08020940480934, -3.8553751872199, 271.28571428571433] 
[10.293684812387, -13.086836248467, 223.85714285714278] 
[-14.2985372924276, -1.0177319851317, 308.7142857142857] 
[14.0882116697593, 3.64095686454205, 214.14285714285717] 
[17.281899473412, 0.0, 236.85714285714283] 
[-23.4830147972807, 13.1039568224149, 223.57142857142856] 
[-23.2644265379186, 3.08880647534979, 264.85714285714283] 
[-26.4427558242157, -9.87307859794568, 231.2857142857143] 
[0.820372228902139, 1.9789037116676, 236.0] 
[-18.8793710259519, -7.18875382006826, 212.57142857142856] 
[1.03372810958989, -0.427995075379145, 215.42857142857144] 
[15.593741641308, 9.03202131188782, 263.85714285714283] 
[0.0143185302015354, -0.109343706188418, 212.42857142857144] 
[-7.35841177487138, 3.47812037613312, 205.42857142857144] 
[-15.6626266309151, -2.96807594597958, 207.14285714285717] 
[12.7585683804745, -6.60642496829413, 214.57142857142856] 
[6.68291489323636, -0.0627302297412312, 206.0] 
[11.2164344836292, -0.922271542378479, 224.42857142857144] 
[-21.1955643984975, -0.609612839435225, 204.14285714285717] 
[-27.8469459428822, -30.352603472329, 204.57142857142856] 
[1.39997475667354, 4.99081428648529, 248.42857142857144] 
[-11.3680233367811, 1.83112606600511, 201.28571428571428] 
[0.0831290507066025, -0.631448680359728, 213.57142857142856] 
[31.6027934665447, 1.92027234306198, 230.0] 
[-0.925609266234381, 0.924358621894434, 268.7142857142857] 
[8.90257854686571, 3.22672246437623, 232.85714285714283] 
[3.4967954772935, 4.59189496382679, 216.71428571428572] 
[8.54614583628313, 2.30894094100325, 256.97533632286996] 
[-31.6494374497476, 22.5502686423849, 202.54932735426007] 
[54.6391863676584, -26.5675958953403, 199.40022421524662] 
[26.547704594272, 3.33733922114082, 264.1428571428571] 
[-5.87161302805198, 10.1699349887908, 271.57142857142856] 
[2.7392999359598, 19.9287687756146, 329.7142857142857] 
[16.0646089489782, -2.99096996346638, 273.85714285714283] 
[21.1496877891311, 14.9288880267371, 266.85714285714283] 
[-1.65686701291133, 0.223505158296121, 217.85714285714278] 
[0.0001078128542182, -54.7538350942, 259.28571428571433] 
[-3.48490122869775, 7.95733439324758, 326.1428571428571] 
[-47.4297999371614, -61.8481563055744, 237.0] 
[39.1713938578975, -35.2046321245306, 271.0] 
[4.79393610419019, 17.8911963410122, 230.2857142857143] 
[2.10236900903113, 3.64129459442287, 322.57142857142856] 
[6.47659107492476, -10.4479837243882, 248.85714285714283] 
[-5.16807087550705, 2.98393230592097, 335.1428571428571] 
[26.6438191298624, 1.2765749571841, 238.85714285714283] 
[-2.9136873514142, -2.16894253556343, 277.57142857142856] 
[17.8303200176665, 43.0384159731363, 232.2857142857143] 
[0.15223116152724, -0.367239016997709, 268.57142857142856] 
[17.7561570210911, 10.2590146345855, 239.0] 
[0.473869316989995, 0.0623013512666949, 321.2857142857143] 
[18.7099884098767, -18.1287558593307, 234.2857142857143] 
[0.758178362766618, -5.76437163824735, 263.57142857142856] 
[-10.2199530450416, 5.90101304313225, 229.1428571428571] 
[-9.9163553786892, -6.70607845383938, 213.85714285714278] 
[103.193798768985, -103.421362051954, 246.2857142857143] 
[2.11038494942728, -0.750773265134441, 330.7142857142857] 
[-6.71362601855505, 52.7033867983648, 231.85714285714283] 
[10.6364769833499, -22.3992774809905, 234.57142857142856] 
[14.5225531697688, -18.7284205776179, 223.28571428571428] 
[-7.46369987321695, -2.64820032302695, 331.0] 
[-7.31225130279024, -2.7592240100692, 241.0] 
[0.560168196703699, -0.727994901128264, 212.14285714285717] 
[-38.2721478397716, -125.891282248333, 219.85714285714278] 
[1.21431796573564, 4.52719627932214, 229.2857142857143] 
[-1.24356538689745, 11.2083451425898, 195.28571428571428] 
[-19.377060838326, 34.2132195477391, 202.28571428571428] 
[-13.0288708155847, -7.43545621904762, 223.0] 
[-1.01696449818081, 3.68388128362393, 206.14285714285717] 
[12.9461610834058, 50.890228037734, 205.0] 
[-10.7669075418522, -2.87609426079118, 231.42857142857144] 
[31.4671557671742, -13.0758764426005, 225.0] 
[9.34055158301574, -5.47994994406948, 208.57142857142856] 
[10.5328576802919, -5.07629015713112, 191.69170403587447] 
[3.84401788031952, -0.0811285511568086, 210.28571428571428] 
[37.6008529423039, -13.0154691582416, 185.2785874439462] 
[3.32228774977341, 5.67023601744633, 218.14285714285717] 
[1.71285402850995, -14.3533012168893, 215.0] 
[-30.9444458803562, 41.9144919520087, 215.14285714285717] 
[-40.7406377248759, -46.1855823071543, 215.0] 
[15.4350393250665, -7.05571934861648, 288.1428571428571] 
[-14.6287058985028, 17.0251199086385, 201.85714285714278] 
[3.78362457769579, -0.491493556254562, 206.14285714285717] 
[-5.08920204610308, 6.63017544792786, 213.42857142857144] 
[1.12682166078517, -9.84760677988706, 239.1428571428571] 
[10.2945875220344, -4.22897046897993, 204.85714285714278] 
[-7.78537704889076e-05, -11.9230406043007, 203.85714285714278] 
[14.7011861205858, -6.23688842573226, 203.57142857142856] 
[-2.16037866229948, 8.10440601341173, 218.42857142857144] 
[-11.0803198391293, 2.52098325111543, 210.42857142857144] 
[-3.73412617054406, 8.58837929786472, 229.71428571428572] 
[30.9066525317819, 10.8177087968839, 214.71428571428572] 
[3.43096320053748, -0.219074754456756, 212.0] 
[2.72998259608515, 0.186555037969575, 193.14285714285717] 
[1.19542669277424, 2.87089119617095, 199.85714285714278] 
[0.0069934328387661, 0.0535507756014749, 191.71428571428572] 
[31.1808695764813, -41.3004394956908, 201.69282511210758] 
[-1.7236618646164, -3.95959191418049, 212.85714285714278] 
[12.4506904866949, 0.862171377334823, 215.14285714285717] 
[-21.8606346395763, 26.7859263127404, 198.0] 
[13.4310451615963, 22.9816300462374, 233.71428571428572] 
[36.2137948518817, 3.81916136260803, 188.28571428571428] 
[7.02904035702526, 26.6681492741475, 226.57142857142856] 
[0.389884363736186, -5.03057015611095, 160.28571428571428] 
[-5.98674509766094, -22.4829405471269, 173.12163677130047] 
[-89.0541453677963, 6.53157988665053, 162.71428571428572] 
[16.4893814124083, 9.33214831223721, 215.42857142857144] 
[26.3757394349979, 0.628529214587552, 169.6730229949523] 
[43.139891578435, 5.92310148953207, 182.14285714285717] 
[5.67153155673249, 1.23340654068308, 187.14285714285717] 
[-0.549728101244016, 37.2275029820349, 223.85714285714278] 
[4.95207857736175, 1.39191653322728, 197.85714285714278] 
[45.5866807730043, 11.9778316109861, 187.71428571428572] 
[18.4466403374582, -8.94205756628708, 179.42857142857144] 
[-62.7248846658271, -16.0823224618547, 178.85714285714278] 
[-5.70246050492873, 1.82128029962746, 197.42857142857144] 
[41.0520066728199, -34.429474868976, 200.57142857142856] 
[0.541825510430332, 0.615975214244832, 203.57142857142856] 
[-23.8173519643895, -31.0396088517925, 234.0] 
[21.776369039122, 4.55471577361593, 199.0] 
[-10.2266499235696, -0.700886510377831, 226.2857142857143] 
[-2.46605164872169, -1.21531272129228, 209.71428571428572] 
[14.7237484898792, 25.621734543429, 200.85714285714278] 
[42.2408041203854, -9.06172588585379, 183.71428571428572] 
[-64.4142193502927, -1.36033981164263, 177.42857142857144] 
[-79.2622535942764, -19.3427379790298, 176.10207515423446] 
[13.8808058385525, 33.6493685304666, 181.71428571428572] 
[-66.6582721706328, 32.022295946709, 161.28571428571428] 
[-25.2350854317482, 6.6699699139386, 171.40022421524662] 
[-7.28675836616818, 5.7958606607313, 187.71428571428572] 
[-84.2560362828958, -2.60405374232095, 164.28571428571428] 
[-6.53155722230524, -25.3676201966736, 166.14285714285717] 
[38.938840788048, 3.87648183571911, 196.85714285714278] 
[-120.50255653622, -45.6980396564277, 175.57142857142856] 
[14.1931600606103, -14.1931650239758, 221.14285714285717] 
[-51.8409890914284, -2.64332198511969, 177.85714285714278] 
[-8.15095176296848, 54.5999272586522, 185.57142857142856] 
[-9.77610008789362, -23.2508685259908, 187.57142857142856] 
[7.41465004835755, 8.18956369324218, 315.42857142857144] 
[10.3062030726147, -101.386052532243, 180.57142857142856] 
[-1.47072618716502, 10.0422457841356, 187.28571428571428] 
[111.139539894273, -86.0764512051986, 153.85714285714278] 
[-83.9604935202124, 13.3400480247689, 172.42857142857144] 
[2.36938269366836, -4.2528186996777, 182.42857142857144] 
[-8.44328765671582, -14.5978082585316, 325.42857142857144] 
[42.4625102287853, 4.51083035555832, 157.0] 
[2.04330896266742, 17.9346201671884, 185.42857142857144] 
[-55.2188953098197, 12.9726025330509, 142.14285714285717] 
[-78.3079558314956, -8.51676545944119, 180.85714285714278] 
[27.7928232414311, 60.0012417163583, 172.28571428571428] 
[-0.0851439682387884, 0.508744769739763, 170.42857142857144] 
[9.29635831923908, -5.21292535211271, 151.85714285714278] 
[23.164768604427, -0.11733300831237, 180.9786995515695] 
[-0.21330127503264, 0.203071970724825, 168.0] 
[4.26374618095498, -4.25840729434161, 178.65956253505328] 
[65.1411188564532, 29.346678568647, 172.97197309417038] 
[-53.3472542400459, -42.9269276790086, 161.42857142857144] 
[-46.4311884357055, 14.5237875125824, 152.57142857142856] 
[14.6777371768241, -0.474387026564017, 165.0] 
[0.898932723707585, 1.76179147265437, 162.85714285714278] 
[-6.58859057272437, 2.47823643016911, 184.6945067264574] 
[-24.3814563433793, 4.4038310830881, 178.57142857142856] 
[-34.6553923077181, 7.22060391497048, 201.42857142857144] 
[-15.8804337539277, -9.52164213944268, 167.42857142857144] 
[28.3600423113039, -11.7019111772882, 199.28571428571428] 
[162.974915210001, -41.6526796165793, 149.85714285714278] 
[0.540744454893503, 0.223985646688402, 346.2857142857143] 
[-33.6193971528405, 9.45169298069935, 153.57142857142856] 
[17.9728552535437, 17.9719988694732, 190.28571428571428] 
[-9.7554141715081, 16.8777327348949, 186.85714285714278] 
[0.454308054782255, -3.44787777167753, 207.42857142857144] 
[-19.2586254181492, -19.2587154877446, 227.0] 
[9.73630246374859, 3.84319438569836, 185.63447501403704] 
[-10.2071323086115, 12.3473659645298, 172.28571428571428] 
[-15.3468140479459, -24.3252663359618, 220.85714285714278] 
[-5.45106367321102, -2.86155497251064, 212.57142857142856] 
[-14.118439506067, -53.6375231143338, 149.57142857142856] 
[-58.0739063754263, 8.91212563243471, 184.0] 
[9.83740801694071, -23.4545827776012, 195.85714285714278] 
[-19.9971684063368, 5.36508774171806, 180.42857142857144] 
[-11.9051426340422, 0.587921101441851, 172.42857142857144] 
[-66.2797493092332, 15.2158655746211, 169.85714285714278] 
[2.47396034763658, 0.166517357565166, 186.28571428571428] 
[137.102791771588, -79.801361206717, 153.57142857142856] 
[107.643000548622, 0.088686140096468, 155.71428571428572] 
[2.80703330409104, 21.966189406252, 175.85714285714278] 
[11.6451772574338, 3.83091862509892, 174.85714285714278] 
[-3.73278766543946, 1.38136889755481, 189.28571428571428] 
[-122.072071269871, 11.3320605334391, 147.57142857142856] 
[-15.9539326756691, -9.83989597335174, 166.71428571428572] 
[104.823347289457, 51.1768609562069, 169.71428571428572] 
[21.634298332525, -22.6390269508073, 144.0] 
[-71.5963535034494, 86.3881253316, 156.14285714285717] 
[-36.0519045301772, -17.5836621415554, 164.14285714285717] 
[55.3831951216258, 34.5272039043999, 142.14285714285717] 
[23.4133514256038, 13.153892569486, 173.57142857142856] 
[13.9871322774518, 61.9751200071983, 173.71428571428572] 
[-31.1326886859598, 2.51629496616437, 138.57142857142856] 
[10.0957164356582, 1.38619403841951, 177.57142857142856] 
[-6.75240813290709, 0.163077110634299, 161.85714285714278] 
[-39.6913204411501, 37.9588612240658, 168.57142857142856] 
[140.89068823227, 73.285800027866, 140.0] 
[199.115145850831, -40.2949440090613, 155.42857142857144] 
[13.6021911699887, 24.6211967118107, 178.14285714285717] 
[1.62633104982778, -0.770745272202633, 162.42857142857144] 
[19.7412766190762, -27.3790905687196, 144.0] 
[-109.24840934967, 58.0828541955574, 187.14285714285717] 
[-49.1216933054939, -33.8546113551534, 169.1137892376682] 
[-41.6708019388423, -24.0671312294194, 214.42857142857144] 
[-122.585346148078, 0.114516810465139, 189.85714285714278] 
[-14.58840716096, 0.142656610400984, 174.93771043771045] 
[44.20125454455, -0.0467667021412112, 347.2857142857143] 
[12.3130797888173, 8.89801861646321, 157.85714285714278] 
[43.0777423094434, 25.0875689160845, 150.24551569506718] 
[50.831255577561, -11.8788848056646, 282.28571428571433] 
[-36.5193690291651, 9.89839278993911, 145.0980941704036] 
[20.6087764388393, -11.7020183653439, 214.42857142857144] 
[40.2361460983424, -8.34889043091051, 346.0] 
[16.5958378883791, 26.1165724060115, 158.82359550561796] 
[16.0636695674272, -2.95556163548063, 179.64814814814815] 
[-10.6160418465769, -5.64979611935049, 154.85714285714278] 
[-18.5019901977873, -10.8253307039773, 149.14285714285717] 
[27.7306403415516, 5.03184231791823, 149.40539023020773] 
[80.8067173118572, 41.5691224300335, 157.9658071748879] 
[29.7142985816129, -79.0359164545443, 139.28571428571428] 
[127.247912776801, -18.5735460711572, 145.85714285714278] 
[207.079175796752, -0.314353730269299, 150.3890134529148] 
[28.5210632334062, 3.31946868476954, 132.71428571428572] 
[-18.5238953935867, -26.167599739907, 155.0] 
[-1.98571355547778, -15.1362290408666, 185.85714285714278] 
[-2.69917265531225, -8.22688192797003, 141.28571428571428] 
[-0.511593255388246, -0.995756031141519, 336.8571428571429] 
[153.429430612099, 64.5739639113823, 172.71428571428572] 
[3.77067412532197, 3.69056643108421, 186.85714285714278] 
[87.9441239497774, 31.0686396685338, 147.14285714285717] 
[9.22858459211357, 5.02444524101939, 187.85714285714278] 
[55.5279077191045, 21.6413337811239, 157.28571428571428] 
[33.5089614707156, -33.9919271765815, 168.14285714285717] 
[-99.647187095814, -11.7410284427472, 150.71428571428572] 
[-23.3350619725845, 1.28746910365998, 161.14285714285717] 
[157.523094629778, 38.2206679909369, 132.42857142857144] 
[-12.548431150092, 94.8494439233254, 181.14285714285717] 
[5.35240280100836, 0.769362511498375, 158.42857142857144] 
[3.70425106979659, 0.41726926237915, 127.71428571428572] 
[-14.65061257481, -2.29613118614298, 174.28571428571428] 
[16.2111672604355, 5.31610398870005, 173.28571428571428] 
[-89.1512818350733, -3.43916471946479, 130.57142857142856] 
[-3.52225143199779, 4.24949973538219, 149.85714285714278] 
[-16.5033951427075, 1.13986152121166, 132.42857142857144] 
[100.928942398784, -23.4515567088536, 162.14285714285717] 
[-117.147947747896, 25.1196102924057, 94.85714285714278] 
[-68.2246709416601, 79.0640669118939, 115.71428571428572] 
[-66.6939465137388, 57.0792397142105, 130.28571428571428] 
[-31.2111999604349, 124.338868326804, 121.0] 
[-78.8861948885713, -27.7717774698512, 149.0] 
[-61.8279607225813, -36.5973453748273, 118.71428571428572] 
[9.87760809796765, -4.02460993757762, 132.14285714285717] 
[-73.6138269141242, 28.6869160249189, 167.57142857142856] 
[-53.6192581188371, -55.910440081384, 166.15553060078605] 
[45.6242203968355, 0.0551025466123443, 148.57142857142856] 
[-77.4010976899465, 42.0572320811173, 145.85714285714278] 
[-20.1990062297494, 52.8443526597219, 139.0] 
[-5.57450684477701, 3.14911788043046, 169.94223219293326] 
[-18.0894186650125, -4.81742196898466, 118.85714285714278] 
[-6.83575026979952, 13.7801016635101, 128.42857142857144] 
[-52.3919526572086, -15.1390708096273, 153.0] 
[70.0938569142902, 40.0265116780141, 147.5285874439462] 
[5.98567917100312, -0.0102677075244911, 88.57142857142861] 
[-64.1558595918806, -50.5262330550954, 96.42857142857144] 
[61.7800895791495, -13.9224216150495, 117.85714285714278] 
[-60.3265661830063, 46.0769564290156, 97.71428571428572] 
[21.6775204757319, 26.8752802554693, 175.71428571428572] 
[23.3294770707665, 75.5822583298209, 69.42857142857144] 
[-46.3507519622653, -0.50379370369694, 43.28571428571428] 
[99.9672664563625, -22.1915145722524, 112.0] 
[-58.4102913453559, -9.84528658659147, 116.61693774537298] 
[-209.724810553016, 56.6774442344025, 59.428571428571445] 
[107.152549168621, -29.8990722925849, 77.42857142857144] 
[156.814173598948, -114.871797229629, 127.28571428571428] 
[166.304831292841, -21.3740954540467, 93.57142857142861] 
[205.394514376768, 125.136785443898, 104.0] 
[245.079276809165, 87.2043277249006, 61.57142857142861] 
[-13.0146669963912, 89.7411178312912, 38.57142857142861] 
[-45.2423234497813, 292.280048402652, 27.0] 
[130.40164452785, 54.3449943153723, 145.28571428571428] 
[38.9341882877316, 58.1403989550395, 112.0] 
[-164.592696375861, 25.2400225529661, 105.57142857142861] 
[35.8092409497757, -77.0401222569603, 23.285714285714278] 
[30.5670086653443, -16.0458588636297, 99.57142857142861] 
[-61.1960824698735, 1.47498566666646, 33.71428571428572] 
[-25.2936163005874, 8.78195838301578, 53.28571428571428] 
[130.043826095283, -174.376422706466, -17.142857142857224] 
[-260.78715025186, -111.348423524841, 74.57142857142861] 
[13.9314167368063, -21.1507070582757, 147.09977578475338] 
[-137.89393577195, 1.60420783854729, 166.71428571428572] 
[18.5813898895145, -6.33620825019687, 91.57142857142861] 
[12.4200706127203, 7.06609253402442, 145.14285714285717] 
[-7.07912503118062, -5.33682588455186, 64.71428571428572] 
[-1.88799228349561, -1.43835513190471, 191.28571428571428] 
[-44.9373508872795, -9.08260232664854, 125.57142857142856] 
[-6.72727206573451, -1.33129738158835, 191.57142857142856] 
[-27.4229156036688, 4.03325214346139, 97.57142857142861] 
[-14.0518662412833, 11.411013798963, 185.57142857142856] 
[20.3915023704037, 18.4045152061596, 94.57142857142861] 
[-46.4471886276433, -2.49957011094798, 164.71428571428572] 
[-6.74540879613327, -6.33331745827951, 131.42857142857144] 
[-5.77577799899538, -0.789560170742142, 61.71428571428572] 
[-8.10568522275253, 13.6406951967265, 96.0] 
[-3.31054627218604, -5.73414875276478, 140.42857142857144] 
[42.4484725246071, -19.7135759388616, 108.57142857142861] 
[-43.493444920573, 5.20524544030258, 133.0] 
[-56.7814660524182, -5.11181849827119, 127.0] 
[-31.4482472412864, -5.36218517864092, 115.0] 
[-14.7860735093991, -71.6782295137384, 117.57142857142861] 
[13.2542490261099, -6.57691844666803, 105.85714285714278] 
[25.5451510933353, -12.4166341986236, 91.28571428571428] 
[-12.260128417053, 8.19256643795948, 124.71428571428572] 
[-70.3795829177404, 34.838431558394, 87.42857142857144] 
[74.835699865252, -2.46540008738738, 84.28571428571428] 
[-6.31954902300191, 0.465082435565026, 88.0] 
[-34.0964268036057, -8.43364275170804, 71.42857142857144] 
[-2.06278642693817, 3.58619110592213, 84.57142857142861] 
[111.971718776468, -40.4956939282714, 110.14285714285722] 
[-78.0277529973577, -24.7980061806782, 96.57142857142861] 
[-87.3269276540191, 5.61197475159911, 161.11266816143495] 
[-33.153284209505, 12.8735522457149, 58.857142857142776] 
[-47.3494017586434, -97.1240142462584, 118.10426008968608] 
[-19.9817476580827, 42.7494947875188, 139.5241031390135] 
[60.9707688959312, 7.093745999679, 164.8239910313901]";

static async Task<string> SendCommand(HttpClient client, dynamic commandObject)
{
    var jsonCommand = JsonSerializer.Serialize(commandObject);
    var commandContent = new StringContent(jsonCommand, Encoding.UTF8, "application/json");
    commandContent.Headers.ContentType = new MediaTypeHeaderValue("application/json");
    var result = await client.PostAsync("http://192.168.0.70/json", commandContent);
    var resultString = await result.Content.ReadAsStringAsync();
    result.EnsureSuccessStatusCode();

    return resultString;
}

using var client = new HttpClient();
client.Timeout = TimeSpan.FromSeconds(10);
Console.WriteLine("Querying status of WLED");
var wledstatus = await client.GetStringAsync("http://192.168.0.70/json/state");

var wledStatusJson = JsonNode.Parse(wledstatus)!;

var segmentJson = wledStatusJson["seg"]![0]!; // TODO: Loop through every LED in every segment properly

var start = (int)segmentJson["start"]!;
var end = (int)segmentJson["stop"]!;

var oldBrightness = (byte)wledStatusJson["bri"]!;

var liveObject = (dynamic)new ExpandoObject();
liveObject.live = false;
liveObject.bri = (byte)255; // Set brightness to full since that seems to impact what full on is when live
await SendCommand(client, liveObject); // Turn live off just in case it's still on...

liveObject.live = true;
await SendCommand(client, liveObject); // So when we turn it on it blanks all the leds

liveObject.live = false; // Not using live for JSON (we do for UDP), but turn it on and off to blank leds
await SendCommand(client, liveObject); // So when we turn it on it blanks all the leds

Console.WriteLine("Checking whether Console.KeyAvailable will work (don't worry about an exception)");
var canQueryKeyAvailable = false;
try { var _ = Console.KeyAvailable; canQueryKeyAvailable = true; }
catch { }
// Connect to WLED via UDP for realtime LED changes
//using var udpClient = new UdpClient();
//udpClient.Connect(IPEndPoint.Parse("192.168.0.70:21324"));
//liveObject.live = true;
//await SendCommand(client, liveObject); // So when we turn it on it blanks all the leds


var udpBytes = new byte[10]; // Enough for 2 LEDs (4 for header, then 3 per led)
udpBytes[0] = 4; // Protocol 4, DNRGB
udpBytes[1] = 2; // Wait 2 seconds before exiting realtime mode having not received any more commands
// Next two bytes are for first LED index
udpBytes[4] = 255;
udpBytes[5] = 255;
udpBytes[6] = 255;
udpBytes[7] = 0;
udpBytes[8] = 0;
udpBytes[9] = 0;


var colourSetObject = (dynamic)new ExpandoObject();
colourSetObject.seg = (dynamic)new ExpandoObject();


var fileText = coords; // TODO: Read from the produced file

var coordinates = fileText.Split('\n').Select(line => new ThreeDPoint(line.Trim().Trim('[', ']').Split(',').Select(s => double.Parse(s)).ToArray())).ToArray();


var coordSelector = new Func<ThreeDPoint, double>(c => c.Z);

var minZ = coordinates.Select(coordSelector).Min();
var maxZ = coordinates.Select(coordSelector).Max();

try
{
    var delta = 10;
    for (var z = minZ;z <= maxZ;z+= delta)
    {
        if (canQueryKeyAvailable && Console.KeyAvailable) { break; }

        colourSetObject.seg.i = coordinates.Select((c, i) => (c, i)).Where(c => coordSelector(c.c) >= z && coordSelector(c.c) <= z + delta).SelectMany(c => new object[] { c.i, "FFFFFF" }).ToArray();
        await SendCommand(client, colourSetObject);
    }
}
finally
{
    // Turn off live mode (for when using UDP) and restore old brightness 
    liveObject.live = false;
    liveObject.bri = oldBrightness;
    await SendCommand(client, liveObject);
}
record ThreeDPoint(double X, double Y, double Z)
{
    public ThreeDPoint(double[] points) : this(points[0], points[1], points[2]) { }
}